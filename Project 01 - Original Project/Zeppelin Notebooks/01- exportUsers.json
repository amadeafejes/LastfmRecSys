{"paragraphs":[{"text":"//read users file\nval rawData = sc.textFile(\"hdfs://127.0.0.1/user/cloudera/lastfm_input/userid-profile.tsv\")\n//output file\nval file = \"hdfs://127.0.0.1/user/cloudera/lastfm_output/users.tsv\"\n//filter header\nval header = rawData.first()\nval filteredData = rawData.filter(_(0) != header(0))\nfilteredData.first\n\n//method for user id\ndef convertUserId(tag: String):Int = {\n    //get int from format \"user_000758\" - last 6 characters\n    return tag.substring(5).toInt\n}\n//insert index for the users\nval users = filteredData.map(s => (convertUserId(s.substring(0, 11)) + \"\\t\" + s))\nusers.take(5)\n\n//save rdd into text file\nusers.saveAsTextFile(file)\n","dateUpdated":"May 22, 2016 2:36:57 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1461687126305_886718684","id":"20160426-091206_1870902117","result":{"code":"SUCCESS","type":"TEXT","msg":"rawData: org.apache.spark.rdd.RDD[String] = hdfs://127.0.0.1/user/cloudera/lastfm_input/userid-profile.tsv MapPartitionsRDD[1] at textFile at <console>:24\nfile: String = hdfs://127.0.0.1/user/cloudera/lastfm_output/users.tsv\nheader: String = #id\tgender\tage\tcountry\tregistered\nfilteredData: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[2] at filter at <console>:27\nres3: String = user_000001\tm\t\tJapan\tAug 13, 2006\nconvertUserId: (tag: String)Int\nusers: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[3] at map at <console>:32\nres7: Array[String] = Array(1\tuser_000001\tm\t\tJapan\tAug 13, 2006, 2\tuser_000002\tf\t\tPeru\tFeb 24, 2006, 3\tuser_000003\tm\t22\tUnited States\tOct 30, 2005, 4\tuser_000004\tf\t\t\tApr 26, 2006, 5\tuser_000005\tm\t\tBulgaria\tJun 29, 2006)\n"},"dateCreated":"Apr 26, 2016 9:12:06 AM","dateStarted":"May 22, 2016 2:36:57 PM","dateFinished":"May 22, 2016 2:38:31 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:54"},{"dateUpdated":"Apr 26, 2016 9:12:06 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1461687126305_886718684","id":"20160426-091206_796321045","dateCreated":"Apr 26, 2016 9:12:06 AM","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:55"}],"name":"01- exportUsers","id":"2BJHWUMHR","angularObjects":{"2BJEX9EKE":[],"2BHNRNXUS":[],"2BHYW4VGK":[],"2BKF83PSM":[],"2BM15S4NY":[],"2BKATJKHF":[],"2BJBC6G63":[],"2BJP5SDEU":[],"2BJAXCR48":[],"2BM76CV5M":[],"2BGC3HU85":[],"2BH7HBVDY":[],"2BJ46877K":[],"2BGV7SN9S":[]},"config":{"looknfeel":"default"},"info":{}}